<!DOCTYPE html>
<html lang="ja"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><title>Wondershakeを退職しました - nownab.log</title><link rel="alternate" type="application/rss+xml" href="https://blog.nownabe.com/feed.xml" title="nownab.log">

  <link rel="icon" type="image/vnd.microsoft.icon" href="/favicon.ico">

  <link rel="stylesheet" href="/css/ress.min.css">
  <link rel="stylesheet" href="/css/chroma.css"><link rel="stylesheet" href="/css/main.501f58350ebcca28a95e886581b0ad2f1446d0d0b5d51b4b75c4fc7c26090852d1e391d6b400cbeea85016589cd48e92f8382226b91ee5c3c0630ae98442e802.css" integrity="sha512-UB9YNQ68yiipXohlgbCtLxRG0NC11RtLdcT8fCYJCFLR45HWtADL7qhQFlic1I6S&#43;DgiJrke5cPAYwrphELoAg==">

  <meta name="author" content="nownabe">
  <meta name="description" content="the nownabe&#39;s life log">

  <meta property="og:site_name" content="nownab.log">
  <meta property="og:type" content="article">

  <meta property="twitter:card" content="summary">
  <meta property="twitter:site" content="@nownabe">
  <meta property="twitter:creator" content="@nownabe">

  <meta property="fb:app_id" content="1775541316016693"><meta property="og:url" content="https://blog.nownabe.com/2019/12/30/leave-wondershake/">
  <meta property="og:title" content="Wondershakeを退職しました - nownab.log">
  <meta property="og:description" content="はじめに いろいろとすぐ忘れてしまうので、感情を込めずに備忘録的な意味で書いてます。 年末にトイレにこもって腹痛と戦いながら書いたので、読んでい"><meta property="og:image" content="https://blog.nownabe.com/img/nownabe.png"><meta property="twitter:title" content="Wondershakeを退職しました - nownab.log">
  <meta property="twitter:description" content="はじめに いろいろとすぐ忘れてしまうので、感情を込めずに備忘録的な意味で書いてます。 年末にトイレにこもって腹痛と戦いながら書いたので、読んでい">
  <meta property="twitter:image" content="https://blog.nownabe.com/">
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-37580164-4', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</head>
<body>
  <div id="site-container"><div id="header-container">
  <header class="container">
    <h1>
      <a href="/">
        nownab.log
      </a>
    </h1>
  </header>
</div>
<div id="content-container">
      <div class="container" role="main">
<article>
  <div class="title">
    <h2><a href="https://blog.nownabe.com/2019/12/30/leave-wondershake/">Wondershakeを退職しました</a></h2>
    <span class="date">Posted on Dec 30, 2019</span>
  </div>
  <div class="body">
    

<h1 id="はじめに">はじめに</h1>

<p>いろいろとすぐ忘れてしまうので、感情を込めずに備忘録的な意味で書いてます。</p>

<p>年末にトイレにこもって腹痛と戦いながら書いたので、読んでいただけると報われます 💩</p>

<p><blockquote class="twitter-tweet"><p lang="ja" dir="ltr">バリ島でもらった下痢もう三日経つのにまだ治らない…</p>&mdash; ぎっくり腰太郎 (@nownabe) <a href="https://twitter.com/nownabe/status/1211454178519703552?ref_src=twsrc%5Etfw">December 30, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<h1 id="在職期間">在職期間</h1>

<p>副業で業務委託として2017年1月から2017年7月まで、正社員として2017年8月から2019年12月まで働いていました。</p>

<p>丸3年ですね。思ってたより長い。</p>

<h1 id="入社理由">入社理由</h1>

<p>他にもいろいろありますが、こんなところが入社理由でした。</p>

<ul>
<li>業務委託として関わっていたので、どういう課題があって何に取り組めそうかがわかっていた</li>
<li>事業責任者が元CTOで話がめちゃくちゃスムーズだった</li>
<li>大学院で学んだ自然言語処理や機械学習の知識をビジネスとして活用できそうだった</li>
<li>提示年収がよかった</li>
<li>裁量が大きかった</li>
<li>フルリモートだった</li>
</ul>

<h1 id="やったこと">やったこと</h1>

<p>メディアサービスのデータ分析基盤・機械学習系とバックエンド・インフラ系をやりました。
入社時点では主にデータ・機械学習系をやる予定でしたが、小さい組織で他にできる人がいないということでバックエンドとインフラもやりました。</p>

<h2 id="データ分析基盤-機械学習系">データ分析基盤・機械学習系</h2>

<p>データ分析基盤の構築や、機械学習プロジェクトの開発やリードをしました。
今まで仕事でやったことがないようなことが多く、楽しかったし勉強にもなりました。
また、大学院で学んだ自然言語処理と機械学習の知識を業務で活用することができました。
研究者としてやっていくには全然足りない知識でしたが、ビジネスだと課題によっては雰囲気で実用的なものが作れたので安心したし楽しかったです。</p>

<p>こんなことをやりました。</p>

<h3 id="データ分析基盤系">データ分析基盤系</h3>

<h4 id="cloud-dataflowやapp-engineを使ったデータパイプラインの構築">Cloud DataflowやApp Engineを使ったデータパイプラインの構築</h4>

<p>Cloud Dataflowでデータパイプラインを構築し、補助的なアプリケーションをApp Engineアプリとして実装しました。</p>

<p>Dataflowがまだそんなに成熟してない頃でした。
PythonのSDKではできないことが多かったのでJavaやKotlinで書きました。
App EngineアプリはJavaやGoで書きました。</p>

<p>謎のエラーが発生したり(クラウド側の問題だった)、SDKの寿命が短かったり、たまに失敗したり、いろいろ大変な部分もありましたが、新しいパラダイムなプログラミングができて楽しかったです。
業務で初めてJava/Kotlinをフルスクラッチで書いたりDataflow使ったりApp Engine使ったり、Dataflowのパラダイムでプログラミングしたりするのは学びも多かったです。</p>

<h4 id="jupyter基盤の構築">Jupyter基盤の構築</h4>

<p>Jupyterでデータ分析したり機械学習いろいろ試したりする基盤を構築しました。</p>

<p>はじめはCloud Datalabで構築しようとしましたが、まだ発表されたばかりで要件を満たせなかったのでやめました。
最終的に、開発者専有のCompute Engineのインスタンスを作成し、そのVM上にDockerコンテナでJupyterを展開するという感じの構成になりました。</p>

<p>開発者専有なので、インスタンスを自動作成・構築するようなスクリプトを用意して、誰でも分析基盤を使えるようにしました。</p>

<p>VMの構築はGCEのstartup scriptとして実装しました。
それまでVMのプロビジョニングにはChef、Ansible、Itamaeを使うことが多かったんですが、結局Bashでコマンドを叩いて自分でnot_ifを定義するみたいな操作が多くなりそうだったのでBashスクリプトを採用しました。
また、Jupyter自体は別にDockerfileとして作っていてVMへのプロビジョニングが不要だったというのも理由です。</p>

<p>筋肉Bashスクリプト書くのは楽しかったし、使いたかったCloud KMSを上手く使って自動化できたのも気持ちよかったです。
healthcheck用のサーバを起動してgcloudコマンドでLBを作ってLet&rsquo;s Encryptで証明書とってNginxを起動するみたいな処理があって苦労した部分だったんですが、gcloudコマンドでLBを作っといたおかげでその後Terraformで構築したりGKEでIngress使ったりが楽にできるようになりました。</p>

<h3 id="機械学習系">機械学習系</h3>

<h4 id="機械学習api基盤構築">機械学習API基盤構築</h4>

<p>学習済みの機械学習モデルによるPrediction APIを動かすための基盤を構築しました。</p>

<p>Go、Python、Kubernetes Engine、Cloud Endpoint、Cloud Storage、Stackdriver Trace、gRPC、Let&rsquo;s Encrypt、らへんの技術スタックで構築しました。
その頃はGCEのLBがHTTP/2に対応してなかったり、Managed Certificateがなかったりで苦労しました。
ゼロからの構築だったので、使いたい技術を使えて楽しかったです。</p>

<p>また、メインのRailsアプリから使えるようにRails側のクライアントをRubyで書いたりもしました。</p>

<h4 id="類似画像検索エンジン開発">類似画像検索エンジン開発</h4>

<p>検索エンジンというほどのものではないんですが、入力画像から類似画像を検索するシステムを開発しました。
簡単な仕組みで、画像の物体認識ラベルのスコアを元に類似度が高い画像を引っ張ってくるというものです。</p>

<p>Pythonで実装した後に高速化のためGoで書き直しました。</p>

<h4 id="記事カテゴリ分類api開発">記事カテゴリ分類API開発</h4>

<p>メディアに掲載する記事のカテゴリを予測する機械学習モデルを作成しました。
また、そのモデルを使って予測を行うAPIを開発しました。</p>

<p>大学院修了してから5年ぐらい経ってましたが、かろうじて覚えてた知識や学び直した知識が一番活きたプロジェクトでした。
それなりの精度で分類できるモデルをそれなりにスムーズに作れたので、研究の経験は無駄ではなかったんだという体験ができてよかったです。</p>

<h4 id="機械学習チームの立ち上げとリード">機械学習チームの立ち上げとリード</h4>

<p>機械学習プロジェクトをやっていくチームを立ち上げ、チームのリードをしました。</p>

<p>といっても機械学習の専門家を集めたわけではなく、バックエンドやフロントエンドは一通りサクッとできて、機械学習も学習しつつ実装していけば専門家には及ばなくても今ある課題は解決できるであろう、任せておけば勝手にいいものを作ってくれるエンジニア2人にお願いして入ってもらいました。
最高のチームだったんですが、いろいろあって解散になってしまいました。</p>

<p>3人で議論したり、模索しながら開発したりして、Wondershakeで唯一「チーム」として活動したプロジェクトでした。</p>

<p>解散したことも含めて、多くの機械学習プロジェクトあるある失敗を踏めたのでいい経験になりました。</p>

<h2 id="バックエンド-インフラ系">バックエンド・インフラ系</h2>

<p>他にやる人がいない、見える人がいない、できる人がいない、らへんの理由からバックエンドやインフラの仕事もしました。
バックエンドでは、Railsアプリのビジネスロジックではない部分の面倒を見たり、その他のバックエンドアプリの面倒をみたり、開発環境やデプロイまわりなどの足回りを整えたりしました。
インフラでは、障害対応、オンコール体制の整備、監視、セキュリティインシデント対応、ステージング構築とか運用も含めてなんかいろいろしました。</p>

<p>一番目立つかつ大きな仕事としてサービスのインフラをAWSからGCPに移行しました。
詳しくは<a href="https://blog.nownabe.com/2019/05/21/migration-to-gcp.html/">この記事</a>に書きました。</p>

<p>移行前は古いインフラでOpsWorksを使ってChefで構築されてたんですが、デプロイが高確率で失敗するとか、インスタンスのOSが古すぎてセキュリティパッチが当てられないとか、Chefがエラーで実行できないとか、インスタンスが人手で変更されてるとかとかとかとか…大変でした。
インフラ移行するみたいな仕事だと、効果が見えにくいので社内から「なにそれ意味あんの？」みたいなこと言われがちだと思うんですが、終わった後にはそんなことも言われず多くの人に感謝されるぐらいには壊れてるインフラでした。</p>

<p>バックエンドはGoやAWS関係のタスクもありましたが、Railsに関するものが多かったです。
パフォーマンスチューニングやバグ対応なんかの細々したものや、APIバージョニングの変更、jbuilder廃止なんかをやりました。</p>

<h1 id="退職理由">退職理由</h1>

<p>書けるものを書くとこんな感じです。</p>

<h3 id="元ctoな事業責任者がいなくなった">元CTOな事業責任者がいなくなった</h3>

<p>前述したとおり元CTOな事業責任者がいたのが大きな入社理由だったんですが、いなくなっていろいろ変化してしまいました。
そのあとに努力して組織をよくせんかいって声が聞こえてきそうですが、組織や人を変えることに対するリターンってよっぽどのことがない限り労力に見合わないのは学習済みなので、その後はほそぼそと生きていました。</p>

<p>あのときの会社の状況から辞めたことは無責任だとは思わなかったし、いろいろ面白い仕事をさせてもらったので元CTOには感謝してます。</p>

<h3 id="3年間1人で働き続けた">3年間1人で働き続けた</h3>

<p>特に後半の1年半ですね。孤独に仕事をしていました。
他のエンジニアに対してコードレビューしたり相談に乗るみたいなことはありましたが、自分のタスクについては社内に相談相手もおらず何から何まで1人でやっているという状態でした。
唯一話ができる週1で入ってくれてる業務委託のエンジニアがいなかったらもっと早く辞めてた気がします。</p>

<p>前半1年半ぐらいは実際の業務は1人でやってたもののCTO事業責任者は健在で話相手がいたし、機械学習チームもあったので特に孤独感はなく働けていました。</p>

<p>どうせそんな状態になるなら、後半はもっとCTO的な立ち回りをしてもよかったのかもしれませんが、Wondershakeではやらないという選択をしました。</p>

<h3 id="自分の能力低下を感じた">自分の能力低下を感じた</h3>

<p>なんというか、脳みそが衰えた感じです。キレがなくなったというか。</p>

<p>集中力の持続時間、選択肢の展開スピード、選択肢の選択スピード、脳内で見える様々な設計の解像度、が低下した気がしています。
コード書いてる時とは別種のアレです。</p>

<p>年齢のせいだとどうしようもないんですが、一番大きい原因は会話してないことじゃないかなーと考えています。
今までを思い返すと脳みそが全開で働いているのを感じたのって誰かと会話していたときが多いんですよね。</p>

<h3 id="やりきった感がでた">やりきった感がでた</h3>

<p>インフラ移行が終わって、やりきった感に支配されました。
事業責任者が変わって外から面白そうなタスクが降ってくることもなくなったところへのやりきった感でした。</p>

<p>もちろんその後も自分で仕事を見つけてやってたんですが、プロダクトは安定してしまって大きな変化はなさそうだし、これからも孤独に仕事するのか？みたいなことを考えるといい区切りかなと感じていました。</p>

<h3 id="成長曲線が下がってきた">成長曲線が下がってきた</h3>

<p>難しくてやりがいがあり、成長できるタスクも多かったんですが、インフラ移行以降は簡単だが手間がかかり面白くないタスクも多々ありました。
そういうタスクの比率が上がってきて、成長を感じにくくなった気がします。</p>

<h3 id="良い機会を得た">良い機会を得た</h3>

<p>そういうタイミングで良いオポがありました。</p>

<h1 id="おわりに">おわりに</h1>

<p>短く終わらせるつもりが長くなってしまいました。</p>

<p>辞めるときは、あー無駄な3年間だったみたいな感情もありましたが、振り返ると全然無駄ではなかったですね。振り返ってよかった。</p>

<p>機械学習を初めて業務としてできたのもよかったし、何よりインフラ移行という大仕事をやり遂げられたのは最高でした。</p>

<p>というか、退職エントリ書いてこうやって振り返るのいいですね。
以前は会社辞めるときっていろんな感情があったので退職エントリ書いてなかったんですが、書いておけばよかった…。</p>

<p>あ、勘違いさせてしまうかもしれないので補足しておくと、以前在籍した会社に特に悪い感情は持ってないし、応援してます。</p>

<p>来年1月から次の会社なので、次もがんばります！</p>

  </div>
</article>

      </div>
    </div>

    <div id="navigation-container">
      <div class="container">

<div id="footer-navigation">
  <div id="next-prev">
    <div><a href="https://blog.nownabe.com/2019/12/13/gcp-updates-december-9-2019/">&lt; GCP Updates | December 9, 2019</a></div>
    <div></div>
  </div>
  <div id="related-articles"></div>
  <div id="sns-buttons">
    <ul>
      <li>
        <div class="twitter-button">
          <a class="twitter-share-button" href="https://twitter.com/share" data-via="nownabe" data-related="nownabe">Tweet</a>
        </div>
      </li>
      <li>
        <div class="fb-like" data-layout="button_count" data-action="like" data-size="small" data-show-faces="false" data-share="true"></div>
      </li>
      <li>
        <a class="hatena-bookmark-button" href="http://b.hatena.ne.jp/entry/" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
          <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;">
        </a>
      </li>
      <li>
        <a class="pocket-btn" data-pocket-label="pocket" data-pocket-count="horizontal" data-lang="en"></a>
      </li>
    </ul>
  </div>
</div>

      </div>
    </div><div id="footer-container">
  <footer class="container">
    <p class="copyright">
      Copyright &copy; 2016
      <img src="/img/nownabe.svg" alt="now">
      nownabe All Right Reserved.
    </p>
  </footer>
  <aside id="information" class="container">
    <ul id="links">
      <li>
        <a href="https://nownabe.github.io/">
          <img src="/img/nownabe.svg" alt="nownabe.github.io">
        </a>
      </li>
      <li>
        <a href="https://github.com/nownabe">
          <img src="/img/github.svg" alt="GitHub">
        </a>
      </li>
      <li>
        <a href="https://qiita.com/nownabe">
          <img src="/img/qiita.svg" alt="Qiita">
        </a>
      </li>
      <li>
        <a href="https://twitter.com/nownabe">
          <img src="/img/twitter.svg" alt="Twitter">
        </a>
      </li>
      <li>
        <a href="https://www.facebook.com/nownabe">
          <img src="/img/facebook.png" alt="Facebook">
        </a>
      </li>
    </ul>
  </aside>
</div>
<div id="fb-root"></div>
  </div>
  <script>
    
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');

    
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.7&appId=1775541316016693";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));

    
    !function(d,i){if(!d.getElementById(i)){var j=d.createElement("script");j.id=i;j.src="https://widgets.getpocket.com/v1/j/btn.js?v=1";var w=d.getElementById(i);d.body.appendChild(j);}}(document,"pocket-btn-js");

  </script>
  <script src="https://b.st-hatena.com/js/bookmark_button.js" async="async"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      anchors.add(".body h1, .body h2, .body h3");
    });
  </script>
</body>
</html>
